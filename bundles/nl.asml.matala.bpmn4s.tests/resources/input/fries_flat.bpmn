<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:bpmn4s="http://bpmn4s" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd">
  <bpmn2:process bpmn4s:ctxName="fries_ctx" bpmn4s:ctxTypeRef="DataType_17t5tar" id="Process_1" isExecutable="false" name="Fries">
    <bpmn2:extensionElements>
      <bpmn4s:dataTypes>
        <bpmn4s:dataType id="DataType_02hh0t9" name="Fries" type="Record">
          <bpmn4s:field name="dressing" typeRef="DataType_2v8mfd7"/>
          <bpmn4s:field name="client_id" typeRef="String"/>
        </bpmn4s:dataType>
        <bpmn4s:dataType id="DataType_17t5tar" name="FriesContext" type="Context">
          <bpmn4s:field name="client_id" typeRef="String"/>
        </bpmn4s:dataType>
        <bpmn4s:dataType id="DataType_1jk4lpg" name="Sauce" type="Enumeration">
          <bpmn4s:literal name="Ketchup"/>
          <bpmn4s:literal name="Mayo"/>
        </bpmn4s:dataType>
        <bpmn4s:dataType id="DataType_2v8mfd7" name="Topping" type="Record">
          <bpmn4s:field name="ctx" typeRef="DataType_17t5tar"/>
          <bpmn4s:field name="sauce" typeRef="DataType_1jk4lpg"/>
          <bpmn4s:literal name="Ketchup"/>
          <bpmn4s:literal name="Mayo"/>
        </bpmn4s:dataType>
      </bpmn4s:dataTypes>
    </bpmn2:extensionElements>
    <bpmn2:startEvent bpmn4s:ctxInit="fries_ctx := FriesContext { client_id = &quot;Tom&quot; }&#10;fries_ctx := FriesContext { client_id = &quot;Bob&quot; }" id="Event_0a5g9gv" name="start_event">
      <bpmn2:outgoing>Flow_0yycfxe</bpmn2:outgoing>
    </bpmn2:startEvent>
    <bpmn2:sequenceFlow id="Flow_0yycfxe" sourceRef="Event_0a5g9gv" targetRef="Gateway_0dqgx0i"/>
    <bpmn2:exclusiveGateway id="Gateway_19p4wo1" name="choice">
      <bpmn2:incoming>Flow_0c47stj</bpmn2:incoming>
      <bpmn2:outgoing>Flow_0gtjn3p</bpmn2:outgoing>
      <bpmn2:outgoing>Flow_1uodqer</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    <bpmn2:sequenceFlow id="Flow_0c47stj" sourceRef="Gateway_0dqgx0i" targetRef="Gateway_19p4wo1"/>
    <bpmn2:parallelGateway id="Gateway_0dqgx0i" name="parallel">
      <bpmn2:incoming>Flow_0yycfxe</bpmn2:incoming>
      <bpmn2:outgoing>Flow_0c47stj</bpmn2:outgoing>
      <bpmn2:outgoing>Flow_0z70hyg</bpmn2:outgoing>
    </bpmn2:parallelGateway>
    <bpmn2:sequenceFlow id="Flow_0gtjn3p" sourceRef="Gateway_19p4wo1" targetRef="Activity_01x82y5"/>
    <bpmn2:sequenceFlow id="Flow_1uodqer" sourceRef="Gateway_19p4wo1" targetRef="Activity_0par2jr"/>
    <bpmn2:sequenceFlow id="Flow_0z70hyg" sourceRef="Gateway_0dqgx0i" targetRef="Activity_1fzja8h"/>
    <bpmn2:sequenceFlow id="Flow_1fk5b3r" sourceRef="Activity_1fzja8h" targetRef="Activity_19yirph"/>
    <bpmn2:sequenceFlow id="Flow_003weme" sourceRef="Activity_19yirph" targetRef="Gateway_1w5n2dh"/>
    <bpmn2:exclusiveGateway id="Gateway_0k04hvx">
      <bpmn2:incoming>Flow_1jnhpia</bpmn2:incoming>
      <bpmn2:incoming>Flow_1ha9jac</bpmn2:incoming>
      <bpmn2:outgoing>Flow_1x3h6dr</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    <bpmn2:sequenceFlow id="Flow_1jnhpia" sourceRef="Activity_01x82y5" targetRef="Gateway_0k04hvx"/>
    <bpmn2:sequenceFlow id="Flow_1ha9jac" sourceRef="Activity_0par2jr" targetRef="Gateway_0k04hvx"/>
    <bpmn2:sequenceFlow id="Flow_1x3h6dr" sourceRef="Gateway_0k04hvx" targetRef="Gateway_1w5n2dh"/>
    <bpmn2:endEvent id="Event_1vt9n85" name="end_event">
      <bpmn2:incoming>Flow_1oh9t4c</bpmn2:incoming>
    </bpmn2:endEvent>
    <bpmn2:sequenceFlow id="Flow_0bwi85w" sourceRef="Gateway_1w5n2dh" targetRef="Activity_0uiz2cy"/>
    <bpmn2:dataStoreReference bpmn4s:dataTypeRef="DataType_2v8mfd7" id="DataStoreReference_18a07df" name="topping"/>
    <bpmn2:sequenceFlow id="Flow_1oh9t4c" sourceRef="Activity_0uiz2cy" targetRef="Event_1vt9n85"/>
    <bpmn2:dataStoreReference bpmn4s:dataTypeRef="DataType_02hh0t9" id="DataStoreReference_03v9xko" name="fries"/>
    <bpmn2:parallelGateway id="Gateway_1w5n2dh" name="join">
      <bpmn2:incoming>Flow_003weme</bpmn2:incoming>
      <bpmn2:incoming>Flow_1x3h6dr</bpmn2:incoming>
      <bpmn2:outgoing>Flow_0bwi85w</bpmn2:outgoing>
    </bpmn2:parallelGateway>
    <bpmn2:task bpmn4s:subType="ComposeTask" id="Activity_0par2jr" name="Choose Mayo">
      <bpmn2:incoming>Flow_1uodqer</bpmn2:incoming>
      <bpmn2:outgoing>Flow_1ha9jac</bpmn2:outgoing>
      <bpmn2:dataOutputAssociation bpmn4s:update="topping := Topping {&#10; ctx = fries_ctx,&#10; sauce = Sauce::Mayo&#10;}" id="DataOutputAssociation_1c91ddd">
        <bpmn2:targetRef>DataStoreReference_18a07df</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
    </bpmn2:task>
    <bpmn2:task bpmn4s:guard="fries_ctx.client_id == &quot;Tom&quot;" bpmn4s:subType="ComposeTask" id="Activity_01x82y5" name="Choose Ketchup">
      <bpmn2:incoming>Flow_0gtjn3p</bpmn2:incoming>
      <bpmn2:outgoing>Flow_1jnhpia</bpmn2:outgoing>
      <bpmn2:dataOutputAssociation bpmn4s:update="topping := Topping {&#10; ctx = fries_ctx,&#10; sauce = Sauce::Ketchup&#10;}" id="DataOutputAssociation_0k1xs1l">
        <bpmn2:targetRef>DataStoreReference_18a07df</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
    </bpmn2:task>
    <bpmn2:task bpmn4s:guard="topping.ctx == fries_ctx" bpmn4s:stepType="fries_flat" bpmn4s:subType="RunTask" id="Activity_19yirph" name="Add Topping">
      <bpmn2:incoming>Flow_1fk5b3r</bpmn2:incoming>
      <bpmn2:outgoing>Flow_003weme</bpmn2:outgoing>
      <bpmn2:property id="Property_1063ktb" name="__targetRef_placeholder"/>
      <bpmn2:dataInputAssociation id="DataInputAssociation_1jmuaop">
        <bpmn2:sourceRef>DataStoreReference_18a07df</bpmn2:sourceRef>
        <bpmn2:targetRef>Property_1063ktb</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataOutputAssociation bpmn4s:update="fries := Fries {&#10; dressing = topping,&#10; client_id = fries_ctx.client_id&#10;}" id="DataOutputAssociation_073boib">
        <bpmn2:targetRef>DataStoreReference_03v9xko</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
    </bpmn2:task>
    <bpmn2:task bpmn4s:stepType="fries_make" id="Activity_1fzja8h" name="Make Fries">
      <bpmn2:incoming>Flow_0z70hyg</bpmn2:incoming>
      <bpmn2:outgoing>Flow_1fk5b3r</bpmn2:outgoing>
    </bpmn2:task>
    <bpmn2:task bpmn4s:assertions="my_fries : assert-that(fries.dressing.sauce) {&#10;    close-to 0 within-margin absolute (2.0)&#10;}" bpmn4s:stepType="fries_flat" bpmn4s:subType="AssertTask" id="Activity_0uiz2cy" name="Eat">
      <bpmn2:incoming>Flow_0bwi85w</bpmn2:incoming>
      <bpmn2:outgoing>Flow_1oh9t4c</bpmn2:outgoing>
      <bpmn2:property id="Property_0unam7w" name="__targetRef_placeholder"/>
      <bpmn2:dataInputAssociation id="DataInputAssociation_0v6iz2i">
        <bpmn2:sourceRef>DataStoreReference_03v9xko</bpmn2:sourceRef>
        <bpmn2:targetRef>Property_0unam7w</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
    </bpmn2:task>
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane bpmnElement="Process_1" id="BPMNPlane_1">
      <bpmndi:BPMNShape bpmnElement="Activity_0par2jr" id="Activity_03eqlvj_di">
        <dc:Bounds height="80" width="100" x="620" y="390"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Activity_19yirph" id="Activity_0bzny2w_di">
        <dc:Bounds height="80" width="100" x="680" y="550"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Activity_1fzja8h" id="Activity_0nja53o_di">
        <dc:Bounds height="80" width="100" x="450" y="550"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Activity_01x82y5" id="Activity_0yjukv4_di">
        <dc:Bounds height="80" width="100" x="620" y="280"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Activity_0uiz2cy" id="Activity_1oq6z79_di">
        <dc:Bounds height="80" width="100" x="1130" y="420"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="DataStoreReference_03v9xko" id="DataStoreReference_03v9xko_di">
        <dc:Bounds height="50" width="50" x="1155" y="635"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="21" x="1169" y="695"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="DataStoreReference_18a07df" id="DataStoreReference_18a07df_di">
        <dc:Bounds height="50" width="50" x="825" y="475"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="36" x="832" y="532"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Event_0a5g9gv" id="Event_0a5g9gv_di">
        <dc:Bounds height="36" width="36" x="132" y="442"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="56" x="122" y="485"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Event_1vt9n85" id="Event_1vt9n85_di">
        <dc:Bounds height="36" width="36" x="1332" y="442"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="53" x="1324" y="485"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_0k04hvx" id="Gateway_0k04hvx_di" isMarkerVisible="true">
        <dc:Bounds height="50" width="50" x="915" y="295"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="75" x="903" y="265"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_0dqgx0i" id="Gateway_0slziyn_di">
        <dc:Bounds height="50" width="50" x="275" y="435"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="37" x="331" y="453"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_19p4wo1" id="Gateway_19p4wo1_di" isMarkerVisible="true">
        <dc:Bounds height="50" width="50" x="445" y="295"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="32" x="454" y="273"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_1w5n2dh" id="Gateway_1d8apr2_di">
        <dc:Bounds height="50" width="50" x="995" y="435"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="17" x="971" y="453"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="DataInputAssociation_0v6iz2i" id="DataInputAssociation_0v6iz2i_di">
        <di:waypoint x="1180" y="635"/>
        <di:waypoint x="1180" y="500"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="DataInputAssociation_1jmuaop" id="DataInputAssociation_1jmuaop_di">
        <di:waypoint x="825" y="500"/>
        <di:waypoint x="730" y="500"/>
        <di:waypoint x="730" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="DataOutputAssociation_073boib" id="DataOutputAssociation_073boib_di">
        <di:waypoint x="730" y="630"/>
        <di:waypoint x="730" y="660"/>
        <di:waypoint x="1155" y="660"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="DataOutputAssociation_0k1xs1l" id="DataOutputAssociation_0k1xs1l_di">
        <di:waypoint x="720" y="290"/>
        <di:waypoint x="850" y="290"/>
        <di:waypoint x="850" y="475"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="DataOutputAssociation_1c91ddd" id="DataOutputAssociation_1c91ddd_di">
        <di:waypoint x="720" y="410"/>
        <di:waypoint x="850" y="410"/>
        <di:waypoint x="850" y="475"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_003weme" id="Flow_003weme_di">
        <di:waypoint x="780" y="590"/>
        <di:waypoint x="1020" y="590"/>
        <di:waypoint x="1020" y="485"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_0bwi85w" id="Flow_0bwi85w_di">
        <di:waypoint x="1045" y="460"/>
        <di:waypoint x="1130" y="460"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_0c47stj" id="Flow_0c47stj_di">
        <di:waypoint x="300" y="435"/>
        <di:waypoint x="300" y="320"/>
        <di:waypoint x="445" y="320"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_0gtjn3p" id="Flow_0gtjn3p_di">
        <di:waypoint x="495" y="320"/>
        <di:waypoint x="620" y="320"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_0yycfxe" id="Flow_0yycfxe_di">
        <di:waypoint x="168" y="460"/>
        <di:waypoint x="275" y="460"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_0z70hyg" id="Flow_0z70hyg_di">
        <di:waypoint x="300" y="485"/>
        <di:waypoint x="300" y="590"/>
        <di:waypoint x="450" y="590"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1fk5b3r" id="Flow_1fk5b3r_di">
        <di:waypoint x="550" y="590"/>
        <di:waypoint x="680" y="590"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1ha9jac" id="Flow_1ha9jac_di">
        <di:waypoint x="720" y="430"/>
        <di:waypoint x="940" y="430"/>
        <di:waypoint x="940" y="345"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1jnhpia" id="Flow_1jnhpia_di">
        <di:waypoint x="720" y="320"/>
        <di:waypoint x="915" y="320"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1oh9t4c" id="Flow_1oh9t4c_di">
        <di:waypoint x="1230" y="460"/>
        <di:waypoint x="1332" y="460"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1uodqer" id="Flow_1uodqer_di">
        <di:waypoint x="470" y="345"/>
        <di:waypoint x="470" y="430"/>
        <di:waypoint x="620" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1x3h6dr" id="Flow_1x3h6dr_di">
        <di:waypoint x="965" y="320"/>
        <di:waypoint x="1020" y="320"/>
        <di:waypoint x="1020" y="435"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>